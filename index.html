<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amit Kumar - Developer Portfolio</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1abc9c;
            --secondary: #2c3e50;
            --text: #333;
            --bg: #f4f4f4;
            --card-bg: #fff;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-hover: 0 8px 20px rgba(0,0,0,0.15);
        }
        [data-theme="dark"] {
            --primary: #16a085;
            --secondary: #34495e;
            --text: #ecf0f1;
            --bg: #2c3e50;
            --card-bg: #34495e;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);
            --shadow-hover: 0 8px 20px rgba(0,0,0,0.35);
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
        }
        html, body {
            height: 100%;
            overflow: hidden;
            scroll-behavior: smooth;
        }
        body {
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }
        .header {
            background: var(--secondary);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1100;
            box-shadow: var(--shadow);
        }
        .header h1 {
            font-size: 1.75rem;
            margin-bottom: 5px;
        }
        .header p {
            font-size: 1rem;
        }
        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding-top: 80px;
        }
        .sidebar {
            width: 250px;
            background: var(--secondary);
            color: white;
            position: fixed;
            top: 80px;
            left: 0;
            height: calc(100% - 80px);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: var(--shadow);
        }
        .sidebar.hidden {
            transform: translateX(-100%);
        }
        .sidebar ul {
            list-style: none;
            padding: 15px 0;
        }
        .sidebar ul li {
            padding: 15px 20px;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
        }
        .sidebar ul li:hover, .sidebar ul li.active {
            background: var(--primary);
        }
        .sidebar ul li i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }
        .main-content {
            width: 100%;
            height: calc(100vh - 80px);
            overflow-y: auto;
            padding: 20px;
            transition: margin-left 0.3s ease;
        }
        section {
            height: 100vh;
            padding: 40px 15px;
            text-align: center;
            display: none; /* Hidden by default */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            overflow-y: auto;
        }
        section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        h2 {
            font-size: 2rem;
            margin-bottom: 30px;
        }
        .card {
            background: var(--card-bg);
            box-shadow: var(--shadow);
            border-radius: 10px;
            padding: 25px;
            margin: 20px auto;
            max-width: 900px;
            width: 100%;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-hover);
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            padding: 20px 0;
            max-width: 1200px;
            margin: 0 auto;
        }
        .project-card, .skill-card, .experience-card, .education-card, .certification-card {
            background: var(--card-bg);
            box-shadow: var(--shadow);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .project-card:hover, .skill-card:hover, .experience-card:hover, .education-card:hover, .certification-card:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-hover);
        }
        .project-media {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        .project-details, .skill-details, .experience-details, .education-details, .certification-details {
            padding: 20px;
        }
        .btn {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
            cursor: pointer;
            border: none;
            display: inline-block;
            margin: 10px 5px 0;
        }
        .btn:hover {
            background: #16a085;
        }
        .edit-btn {
            background: #27ae60;
        }
        .edit-btn:hover {
            background: #2ecc71;
        }
        .delete-btn {
            background: #e74c3c;
        }
        .delete-btn:hover {
            background: #c0392b;
        }
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 5px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 1rem;
        }
        .hidden { display: none; }
        .profile-container {
            position: relative;
            width: 180px;
            height: 180px;
            margin: 0 auto 30px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }
        .profile-pic {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .profile-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            opacity: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.3s;
        }
        .profile-container:hover {
            transform: scale(1.05);
        }
        .profile-container:hover .profile-overlay {
            opacity: 1;
        }
        .crop-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 2000;
            width: 90%;
            max-width: 400px;
        }
        .crop-preview {
            max-width: 100%;
            max-height: 300px;
            margin-bottom: 15px;
        }
        .progress-bar {
            background: #ddd;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress {
            height: 100%;
            background: var(--primary);
            transition: width 0.5s ease;
        }
        .tooltip {
            position: relative;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 100px;
            background: var(--secondary);
            color: white;
            text-align: center;
            border-radius: 5px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            z-index: 1000;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }
        .back-to-top:hover {
            transform: scale(1.1);
        }
        .back-to-top.visible {
            display: block;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .container {
                flex-direction: row;
            }
            .sidebar {
                transform: translateX(0);
            }
            .sidebar.hidden {
                width: 60px;
            }
            .sidebar.hidden ul li span {
                display: none;
            }
            .main-content {
                margin-left: 250px;
                width: calc(100% - 250px);
                padding: 30px;
            }
            .main-content.expanded {
                margin-left: 60px;
                width: calc(100% - 60px);
            }
            .header h1 {
                font-size: 2.25rem;
            }
            .header p {
                font-size: 1.25rem;
            }
            .profile-container {
                width: 220px;
                height: 220px;
            }
        }
        @media (max-width: 767px) {
            .sidebar {
                width: 100%;
                max-width: 250px;
            }
            .main-content {
                margin-left: 0;
                padding: 15px;
            }
            .grid-container {
                grid-template-columns: 1fr;
            }
            .project-media {
                height: 150px;
            }
            section {
                padding: 30px 10px;
            }
            h2 {
                font-size: 1.75rem;
            }
            .card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>Amit Kumar</h1>
        <p>Web Developer & Data Science Enthusiast</p>
    </div>

    <!-- Authentication Section -->
    <div id="auth-section" class="hidden">
        <div class="card">
            <h2>Admin Authentication</h2>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="email" placeholder="Enter your email" required>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="password" placeholder="Enter your password" required>
            </div>
            <button onclick="signup()" class="btn">Sign Up</button>
            <button onclick="login()" class="btn">Login</button>
        </div>
    </div>

    <!-- Portfolio Container -->
    <div id="portfolio-section" class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar" id="sidebar">
            <ul>
                <li onclick="showSection('about')"><i class="fas fa-user"></i><span>About Me</span></li>
                <li onclick="showSection('education')"><i class="fas fa-graduation-cap"></i><span>Education</span></li>
                <li onclick="showSection('skills')"><i class="fas fa-tools"></i><span>Skills</span></li>
                <li onclick="showSection('experience')"><i class="fas fa-briefcase"></i><span>Experience</span></li>
                <li onclick="showSection('projects')"><i class="fas fa-project-diagram"></i><span>Projects</span></li>
                <li onclick="showSection('certifications')"><i class="fas fa-certificate"></i><span>Certifications</span></li>
                <li onclick="showSection('contact')"><i class="fas fa-envelope"></i><span>Contact</span></li>
                <li onclick="toggleAdmin()" id="auth-btn"><i class="fas fa-lock"></i><span>Admin</span></li>
                <li onclick="toggleTheme()" id="theme-btn"><i class="fas fa-moon"></i><span>Dark Mode</span></li>
                <li onclick="toggleSidebar()" id="toggle-btn"><i class="fas fa-bars"></i><span>Toggle</span></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- About Section -->
            <section id="about">
                <div class="card">
                    <div class="profile-container" id="profile-container">
                        <img id="profile-pic" class="profile-pic" src="" alt="Amit Kumar">
                        <div class="profile-overlay hidden" id="profile-overlay">
                            <button class="edit-btn" onclick="document.getElementById('profile-upload').click()">Change</button>
                        </div>
                    </div>
                    <input type="file" id="profile-upload" accept="image/*" onchange="startCrop()" class="hidden">
                    <h2 contenteditable="false" id="about-title">About Me</h2>
                    <p contenteditable="false" id="about-desc">I’m a passionate web developer and data science enthusiast currently pursuing a Diploma in Computer Science & Engineering. With hands-on experience from internships and academic projects, I specialize in Python, HTML, CSS, Git, and Docker. I’m collaborative, adaptable, and driven to create efficient, innovative solutions for DevOps and data science challenges.</p>
                    <video id="about-video" controls class="hidden" style="width: 100%; max-height: 300px; margin-top: 20px;"></video>
                    <input type="file" id="video-upload" accept="video/*" onchange="uploadVideo()" class="hidden">
                    <button class="edit-btn hidden" onclick="toggleEdit('about')" id="about-edit-btn">Edit</button>
                    <button class="edit-btn hidden" onclick="saveContent('about')" id="about-save-btn">Save</button>
                </div>
            </section>

            <!-- Education Section -->
            <section id="education">
                <h2>Education</h2>
                <div id="education-grid" class="grid-container">
                    <div class="education-card">
                        <div class="education-details">
                            <h3>Diploma in Computer Science & Engineering</h3>
                            <p><strong>2022 - Present</strong></p>
                            <p>Government Polytechnic Gulzarbagh, Patna 800007</p>
                        </div>
                    </div>
                    <div class="education-card">
                        <div class="education-details">
                            <h3>Intermediate in Science</h3>
                            <p><strong>2020 - 2022</strong></p>
                            <p>S. Sinha College, Aurangabad, Bihar</p>
                        </div>
                    </div>
                    <div class="education-card">
                        <div class="education-details">
                            <h3>Matriculation</h3>
                            <p><strong>2019 - 2020</strong></p>
                            <p>High School Beri, Aurangabad, Bihar</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Skills Section -->
            <section id="skills">
                <h2>Skills</h2>
                <div id="skills-grid" class="grid-container"></div>
                <div class="card hidden" id="skill-form">
                    <h3>Add Skill</h3>
                    <div class="form-group">
                        <label>Skill Name</label>
                        <input type="text" id="skill-name" placeholder="Enter skill name">
                    </div>
                    <div class="form-group">
                        <label>Proficiency (0-100)</label>
                        <input type="number" id="skill-level" placeholder="Level" min="0" max="100">
                    </div>
                    <button class="btn" onclick="addSkill()">Add Skill</button>
                </div>
            </section>

            <!-- Experience Section -->
            <section id="experience">
                <h2>Experience</h2>
                <div id="experience-grid" class="grid-container">
                    <div class="experience-card">
                        <div class="experience-details">
                            <h3>Web Development Internship</h3>
                            <p><strong>Oct 2023 - Nov 2023</strong></p>
                            <p>Khabai Tech Private Ltd, Hajipur, Bihar, India</p>
                        </div>
                    </div>
                    <div class="experience-card">
                        <div class="experience-details">
                            <h3>Data Science using Python Internship</h3>
                            <p><strong>Sep 2024 - Oct 2024</strong></p>
                            <p>NIELIT Patna</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Projects Section -->
            <section id="projects">
                <h2>Projects</h2>
                <div id="project-grid" class="grid-container"></div>
                <div class="card hidden" id="project-form">
                    <h3>Add Project</h3>
                    <div class="form-group">
                        <label>Project Title</label>
                        <input type="text" id="project-title" placeholder="Enter project title">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="project-desc" placeholder="Enter description" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label>GitHub Link</label>
                        <input type="text" id="project-link" placeholder="Enter GitHub URL">
                    </div>
                    <div class="form-group">
                        <label>Media (optional)</label>
                        <input type="file" id="project-upload" accept="image/*,video/*" onchange="previewMedia()">
                    </div>
                    <div id="media-preview"></div>
                    <button class="btn" onclick="addProject()">Add Project</button>
                </div>
            </section>

            <!-- Certifications Section -->
            <section id="certifications">
                <h2>Certifications</h2>
                <div id="certifications-grid" class="grid-container">
                    <div class="certification-card">
                        <div class="certification-details">
                            <h3>Web Development</h3>
                            <p><strong>Tech:</strong> HTML, CSS, JavaScript, Bootstrap, Git & GitHub</p>
                        </div>
                    </div>
                    <div class="certification-card">
                        <div class="certification-details">
                            <h3>Data Science using Python</h3>
                            <p><strong>Tech:</strong> Python</p>
                        </div>
                    </div>
                    <div class="certification-card">
                        <div class="certification-details">
                            <h3>KYP Certificate</h3>
                            <p><strong>Tech:</strong> BSCIT, BSCSS, BSCLS</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Contact Section -->
            <section id="contact">
                <div class="card">
                    <h2>Contact Me</h2>
                    <p><i class="fab fa-linkedin"></i> <a href="https://www.linkedin.com/in/amit-kumarbb8088296" target="_blank">linkedin.com/in/amit-kumarbb8088296</a></p>
                    <form id="contact-form">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" id="contact-name" placeholder="Your name" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="contact-email" placeholder="Your email" required>
                        </div>
                        <div class="form-group">
                            <label>Message</label>
                            <textarea id="contact-message" placeholder="Your message" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn">Send Message</button>
                    </form>
                </div>
                <div class="card hidden" id="messages-dashboard">
                    <h3>Messages</h3>
                    <div id="messages-list"></div>
                </div>
            </section>
        </div>
    </div>

    <!-- Crop Modal -->
    <div id="crop-modal" class="crop-container hidden">
        <h3>Crop Profile Picture</h3>
        <img id="crop-preview" class="crop-preview">
        <button class="btn" onclick="cropImage()">Crop & Save</button>
        <button class="btn delete-btn" onclick="closeCropModal()">Cancel</button>
    </div>

    <!-- Back to Top Button -->
    <div class="back-to-top" id="back-to-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // State Management
        let admin = false;
        let sidebarOpen = false;
        let cropper;
        const data = {
            skills: safeParse(localStorage.getItem('skills')) || [
                { name: 'HTML, CSS, JavaScript', level: 85 },
                { name: 'Bootstrap', level: 80 },
                { name: 'Tailwind CSS', level: 75 },
                { name: 'Python', level: 90 },
                { name: 'C', level: 70 },
                { name: 'Databases', level: 65 },
                { name: 'Linux, Windows', level: 80 },
                { name: 'Git & GitHub', level: 85 },
                { name: 'Docker', level: 70 },
                { name: 'Shell Scripting', level: 65 },
                { name: 'Django', level: 75 },
                { name: 'Management Skills', level: 80 },
                { name: 'Communication Skills', level: 85 },
                { name: 'Teamwork', level: 90 },
                { name: 'Microsoft Office', level: 80 },
                { name: 'Critical Thinking', level: 85 },
                { name: 'Leadership', level: 75 }
            ],
            projects: safeParse(localStorage.getItem('projects')) || [
                { title: 'Drserve', desc: 'A comprehensive extensible hospital management system.', link: '#', media: 'https://via.placeholder.com/300x200?text=Drserve', mediaType: 'image' },
                { title: 'Railway Reservation System', desc: 'A Python-based system where users can book tickets, check status, cancel tickets, and view fare info.', link: '#', media: 'https://via.placeholder.com/300x200?text=Railway+System', mediaType: 'image' },
                { title: 'Library Management System', desc: 'A Python-based system for managing library operations, including books and staff.', link: '#', media: 'https://via.placeholder.com/300x200?text=Library+System', mediaType: 'image' }
            ],
            about: safeParse(localStorage.getItem('about')) || { 
                title: 'About Me', 
                desc: 'I’m a passionate web developer and data science enthusiast currently pursuing a Diploma in Computer Science & Engineering. With hands-on experience from internships and academic projects, I specialize in Python, HTML, CSS, Git, and Docker. I’m collaborative, adaptable, and driven to create efficient, innovative solutions for DevOps and data science challenges.', 
                video: '', 
                profilePic: '' 
            },
            messages: safeParse(localStorage.getItem('messages')) || []
        };

        // Utility to safely parse JSON
        function safeParse(json) {
            try {
                return JSON.parse(json);
            } catch (e) {
                console.error('Failed to parse JSON:', e);
                return null;
            }
        }

        // Initialization
        document.addEventListener('DOMContentLoaded', () => {
            loadAdminState();
            renderSkills();
            renderProjects();
            renderAbout();
            setupContactForm();
            loadTheme();
            updateSidebarState();
            showSection('about'); // Show "About" section by default
            window.addEventListener('resize', debounce(updateSidebarState, 200));
        });

        // Authentication
        function signup() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            if (email && password.length >= 6) {
                localStorage.setItem('adminEmail', email);
                localStorage.setItem('adminPassword', password);
                alert('Signed up successfully! Please log in.');
            } else {
                alert('Please enter a valid email and a password (min 6 characters)');
            }
        }

        function login() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            const savedEmail = localStorage.getItem('adminEmail');
            const savedPassword = localStorage.getItem('adminPassword');
            if (email === savedEmail && password === savedPassword) {
                admin = true;
                localStorage.setItem('adminLoggedIn', 'true');
                toggleAdminUI();
            } else {
                alert('Invalid credentials');
            }
        }

        function logout() {
            admin = false;
            localStorage.removeItem('adminLoggedIn');
            toggleAdminUI();
        }

        function loadAdminState() {
            if (localStorage.getItem('adminLoggedIn') === 'true') {
                admin = true;
                toggleAdminUI();
            }
        }

        function toggleAdmin() {
            if (admin) {
                logout();
            } else {
                document.getElementById('auth-section').classList.remove('hidden');
                document.getElementById('portfolio-section').classList.add('hidden');
            }
        }

        function toggleAdminUI() {
            const authBtn = document.getElementById('auth-btn');
            authBtn.innerHTML = admin ? `<i class="fas fa-sign-out-alt"></i><span>Logout</span>` : `<i class="fas fa-lock"></i><span>Admin</span>`;
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('portfolio-section').classList.remove('hidden');
            document.getElementById('skill-form').classList.toggle('hidden', !admin);
            document.getElementById('project-form').classList.toggle('hidden', !admin);
            document.getElementById('about-edit-btn').classList.toggle('hidden', !admin);
            document.getElementById('video-upload').classList.toggle('hidden', !admin);
            document.getElementById('profile-overlay').classList.toggle('hidden', !admin);
            document.getElementById('messages-dashboard').classList.toggle('hidden', !admin);
            if (admin) renderMessages();
        }

        // Sidebar
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            updateSidebarState();
        }

        function updateSidebarState() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            if (window.innerWidth >= 768) {
                sidebar.classList.remove('hidden');
                mainContent.classList.toggle('expanded', !sidebarOpen);
            } else {
                sidebar.classList.toggle('hidden', !sidebarOpen);
                mainContent.classList.remove('expanded');
            }
        }

        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            body.setAttribute('data-theme', currentTheme === 'dark' ? 'light' : 'dark');
            localStorage.setItem('theme', body.getAttribute('data-theme'));
            document.getElementById('theme-btn').innerHTML = body.getAttribute('data-theme') === 'dark' 
                ? `<i class="fas fa-sun"></i><span>Light Mode</span>` 
                : `<i class="fas fa-moon"></i><span>Dark Mode</span>`;
        }

        function loadTheme() {
            const theme = localStorage.getItem('theme') || 'light';
            document.body.setAttribute('data-theme', theme);
            document.getElementById('theme-btn').innerHTML = theme === 'dark' 
                ? `<i class="fas fa-sun"></i><span>Light Mode</span>` 
                : `<i class="fas fa-moon"></i><span>Dark Mode</span>`;
        }

        // Section Navigation
        function showSection(sectionId) {
            const sections = document.querySelectorAll('section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                targetSection.scrollTop = 0; // Reset scroll position
            }
            if (window.innerWidth < 768) {
                sidebarOpen = false;
                updateSidebarState();
            }
        }

        function scrollToTop() {
            const activeSection = document.querySelector('section.active');
            if (activeSection) {
                activeSection.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Debounce Utility
        function debounce(func, wait) {
            let timeout;
            return function (...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        // Back to Top
        function setupBackToTop() {
            const btn = document.getElementById('back-to-top');
            document.querySelector('.main-content').addEventListener('scroll', debounce(() => {
                btn.classList.toggle('visible', document.querySelector('.main-content').scrollTop > 300);
            }, 100));
        }

        // About Section
        function renderAbout() {
            const { title, desc, video, profilePic } = data.about;
            document.getElementById('about-title').textContent = title || 'About Me';
            document.getElementById('about-desc').textContent = desc || 'No description available.';
            const videoEl = document.getElementById('about-video');
            if (video) {
                videoEl.src = video;
                videoEl.classList.remove('hidden');
            } else {
                videoEl.classList.add('hidden');
            }
            document.getElementById('profile-pic').src = profilePic || 'https://via.placeholder.com/200?text=Amit+Kumar';
        }

        function toggleEdit(section) {
            const title = document.getElementById(`${section}-title`);
            const desc = document.getElementById(`${section}-desc`);
            const editBtn = document.getElementById(`${section}-edit-btn`);
            const saveBtn = document.getElementById(`${section}-save-btn`);
            const isEditable = title.isContentEditable;
            title.contentEditable = !isEditable;
            desc.contentEditable = !isEditable;
            editBtn.classList.toggle('hidden');
            saveBtn.classList.toggle('hidden');
        }

        function saveContent(section) {
            const title = document.getElementById(`${section}-title`).textContent.trim();
            const desc = document.getElementById(`${section}-desc`).textContent.trim();
            if (title && desc) {
                data.about = { ...data.about, title, desc };
                localStorage.setItem('about', JSON.stringify(data.about));
                toggleEdit(section);
            } else {
                alert('Please enter both a title and description.');
            }
        }

        function uploadVideo() {
            const file = document.getElementById('video-upload').files[0];
            if (file && file.type.includes('video')) {
                const reader = new FileReader();
                reader.onload = () => {
                    data.about.video = reader.result;
                    localStorage.setItem('about', JSON.stringify(data.about));
                    renderAbout();
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please upload a valid video file');
            }
        }

        // Profile Picture Cropping
        function startCrop() {
            const file = document.getElementById('profile-upload').files[0];
            if (file && file.type.includes('image')) {
                const reader = new FileReader();
                reader.onload = () => {
                    const preview = document.getElementById('crop-preview');
                    preview.src = reader.result;
                    document.getElementById('crop-modal').classList.remove('hidden');
                    if (cropper) cropper.destroy();
                    cropper = new Cropper(preview, {
                        aspectRatio: 1,
                        viewMode: 1,
                        autoCropArea: 0.8,
                        responsive: true
                    });
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please upload a valid image file');
            }
        }

        function cropImage() {
            if (cropper) {
                const canvas = cropper.getCroppedCanvas({ width: 220, height: 220 });
                data.about.profilePic = canvas.toDataURL('image/jpeg');
                localStorage.setItem('about', JSON.stringify(data.about));
                renderAbout();
                closeCropModal();
            }
        }

        function closeCropModal() {
            document.getElementById('crop-modal').classList.add('hidden');
            if (cropper) {
                cropper.destroy();
                cropper = null;
            }
            document.getElementById('profile-upload').value = '';
        }

        // Skills Section
        function renderSkills() {
            const grid = document.getElementById('skills-grid');
            grid.innerHTML = '';
            data.skills.forEach((skill, index) => {
                const card = document.createElement('div');
                card.className = 'skill-card tooltip';
                card.innerHTML = `
                    <div class="skill-details">
                        <h3>${skill.name}</h3>
                        <div class="progress-bar">
                            <div class="progress" style="width: ${skill.level}%"></div>
                        </div>
                        ${admin ? `<button class="delete-btn" onclick="deleteSkill(${index})">Delete</button>` : ''}
                    </div>
                    <span class="tooltiptext">${skill.level}%</span>
                `;
                grid.appendChild(card);
            });
        }

        function addSkill() {
            const name = document.getElementById('skill-name').value.trim();
            const level = parseInt(document.getElementById('skill-level').value);
            if (name && !isNaN(level) && level >= 0 && level <= 100) {
                data.skills.push({ name, level });
                localStorage.setItem('skills', JSON.stringify(data.skills));
                renderSkills();
                document.getElementById('skill-name').value = '';
                document.getElementById('skill-level').value = '';
            } else {
                alert('Please enter a valid skill name and level (0-100)');
            }
        }

        function deleteSkill(index) {
            data.skills.splice(index, 1);
            localStorage.setItem('skills', JSON.stringify(data.skills));
            renderSkills();
        }

        // Projects Section
        function renderProjects() {
            const grid = document.getElementById('project-grid');
            grid.innerHTML = '';
            data.projects.forEach((project, index) => {
                const card = document.createElement('div');
                card.className = 'project-card';
                card.innerHTML = `
                    <${project.mediaType === 'video' ? 'video' : 'img'} 
                        src="${project.media || 'https://via.placeholder.com/300x200?text=' + project.title}" 
                        ${project.mediaType === 'video' ? 'controls' : ''} 
                        class="project-media">
                    </${project.mediaType === 'video' ? 'video' : 'img'}>
                    <div class="project-details">
                        <h3>${project.title}</h3>
                        <p>${project.desc}</p>
                        <a href="${project.link}" target="_blank" class="btn">View Project</a>
                        ${admin ? `<button class="delete-btn" onclick="deleteProject(${index})">Delete</button>` : ''}
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function previewMedia() {
            const file = document.getElementById('project-upload').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => {
                    const preview = document.getElementById('media-preview');
                    preview.innerHTML = file.type.includes('video') 
                        ? `<video src="${reader.result}" controls class="project-media"></video>`
                        : `<img src="${reader.result}" class="project-media">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function addProject() {
            const title = document.getElementById('project-title').value.trim();
            const desc = document.getElementById('project-desc').value.trim();
            const link = document.getElementById('project-link').value.trim();
            const file = document.getElementById('project-upload').files[0];
            if (title && desc && link) {
                if (file) {
                    const reader = new FileReader();
                    reader.onload = () => {
                        data.projects.push({
                            title,
                            desc,
                            link,
                            media: reader.result,
                            mediaType: file.type.includes('video') ? 'video' : 'image'
                        });
                        localStorage.setItem('projects', JSON.stringify(data.projects));
                        renderProjects();
                        clearProjectForm();
                    };
                    reader.readAsDataURL(file);
                } else {
                    data.projects.push({ title, desc, link, media: '', mediaType: 'image' });
                    localStorage.setItem('projects', JSON.stringify(data.projects));
                    renderProjects();
                    clearProjectForm();
                }
            } else {
                alert('Please fill all required project fields');
            }
        }

        function deleteProject(index) {
            data.projects.splice(index, 1);
            localStorage.setItem('projects', JSON.stringify(data.projects));
            renderProjects();
        }

        function clearProjectForm() {
            document.getElementById('project-title').value = '';
            document.getElementById('project-desc').value = '';
            document.getElementById('project-link').value = '';
            document.getElementById('project-upload').value = '';
            document.getElementById('media-preview').innerHTML = '';
        }

        // Contact Section
        function setupContactForm() {
            const form = document.getElementById('contact-form');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('contact-name').value.trim();
                const email = document.getElementById('contact-email').value.trim();
                const message = document.getElementById('contact-message').value.trim();
                if (name && email && message && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    data.messages.push({ name, email, message, date: new Date().toISOString() });
                    localStorage.setItem('messages', JSON.stringify(data.messages));
                    alert('Message sent successfully!');
                    form.reset();
                    if (admin) renderMessages();
                } else {
                    alert('Please fill all fields with a valid email');
                }
            });
        }

        function renderMessages() {
            const list = document.getElementById('messages-list');
            list.innerHTML = '';
            data.messages.forEach((msg, index) => {
                const div = document.createElement('div');
                div.className = 'card';
                div.style.marginTop = '20px';
                div.innerHTML = `
                    <p><strong>Name:</strong> ${msg.name}</p>
                    <p><strong>Email:</strong> ${msg.email}</p>
                    <p><strong>Message:</strong> ${msg.message}</p>
                    <p><strong>Date:</strong> ${new Date(msg.date).toLocaleString()}</p>
                    <button class="delete-btn" onclick="deleteMessage(${index})">Delete</button>
                `;
                list.appendChild(div);
            });
        }

        function deleteMessage(index) {
            data.messages.splice(index, 1);
            localStorage.setItem('messages', JSON.stringify(data.messages));
            renderMessages();
        }

        // Setup Back to Top after DOM is loaded
        document.addEventListener('DOMContentLoaded', setupBackToTop);
    </script>
    <!-- Include Cropper.js for image cropping -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" rel="stylesheet">
</body>
</html>
